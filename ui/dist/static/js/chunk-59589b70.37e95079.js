(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-59589b70"],{"19f8":function(t,e,o){"use strict";o("3fcd")},"3fcd":function(t,e,o){},5613:function(t,e,o){t.exports=o.p+"static/img/project.44caa3b8.png"},"707c":function(t,e,o){"use strict";o.r(e);var r=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"page-container"},[r("el-card",{staticClass:"panel-header",staticStyle:{"margin-bottom":"20px"},attrs:{"body-style":"padding:0;"}},[r("div",{staticStyle:{display:"flex","justify-content":"space-between"},attrs:{slot:"header"},slot:"header"},[r("span",[r("el-button",{staticStyle:{float:"right",margin:"0 10px 0 0"},attrs:{size:"mini",type:"primary"},on:{click:t.handleAdd}},[t._v(t._s(t.$t("project.createproject")))])],1)])]),r("div",{staticClass:"home-card"},t._l(t.projectlist,(function(e){return r("div",{key:e.project_id,staticClass:"home-item"},[r("a",{on:{click:function(o){return t.viewDashboard(e.project_id)}}},[r("img",{staticClass:"home-img",attrs:{src:o("5613")}})]),r("div",{staticClass:"home-right"},[r("span",{staticStyle:{color:"#999",fontSize:"16px"}},[r("a",{attrs:{href:"#"},on:{click:function(o){return t.viewDashboard(e.project_id)}}},[t._v(t._s(e.project_name))]),r("el-dropdown",{attrs:{szie:"mini",trigger:"click"},on:{command:t.handleCommand}},[r("span",{staticClass:"el-dropdown-link"},[r("i",{staticClass:"el-icon-more"})]),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[r("el-dropdown-item",{attrs:{command:{type:"edit",target:e}}},[t._v(t._s(t.$t("common.edit")))]),r("el-dropdown-item",{attrs:{command:{type:"delete",target:e}}},[t._v(t._s(t.$t("common.delete")))])],1)],1)],1),r("span",{staticStyle:{color:"#999",fontSize:"14px"}},[t._v(t._s(e.creator_username))]),r("span",{staticStyle:{color:"#999",fontSize:"14px"}},[t._v(t._s(1==e.private_status?"非公开":"公开"))]),r("span",{staticStyle:{color:"#999",fontSize:"14px"}},[t._v(t._s(e.created_at))])])])})),0),r("el-dialog",{attrs:{title:t.title,visible:t.open,width:"600px","append-to-body":""},on:{"update:visible":function(e){t.open=e}}},[r("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"120px"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"项目名称",prop:"project_name"}},[r("el-input",{attrs:{placeholder:"请输入项目"},model:{value:t.form.project_name,callback:function(e){t.$set(t.form,"project_name",e)},expression:"form.project_name"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:20}},[r("el-form-item",{attrs:{label:"项目描述",prop:"project_desc"}},[r("el-input",{attrs:{type:"textarea",rows:3,placeholder:"项目介绍"},model:{value:t.form.project_desc,callback:function(e){t.$set(t.form,"project_desc",e)},expression:"form.project_desc"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"是否公开",prop:"is_public"}},[r("el-checkbox",{key:"0",model:{value:t.form.is_public,callback:function(e){t.$set(t.form,"is_public",e)},expression:"form.is_public"}},[t._v("公开")])],1)],1)],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("确 定")]),r("el-button",{on:{click:t.cancel}},[t._v("取 消")])],1)],1)],1)},c=[],n=o("b775");o("a0ce");function s(){return Object(n["a"])({url:"/rest/project/list",method:"get"})}function i(t){return Object(n["a"])({url:"/rest/project/create",method:"post",data:t})}function a(t){return Object(n["a"])({url:"/rest/project/update",method:"put",data:t})}function l(t){return Object(n["a"])({url:"/rest/project/query/".concat(t),method:"get"})}function d(t){return Object(n["a"])({url:"/rest/project/delete/".concat(t),method:"delete"})}o("5f87"),o("ed08");var p={name:"project",data:function(){return{projectlist:[],form:[],loading:!0,title:"",count:0,open:!1,rules:{project_name:[{required:!0,message:"项目名称不能为空",trigger:"blur"}]}}},created:function(){this.getProjects()},methods:{handleCommand:function(t){"edit"===t.type?this.handleEdit(t.target):this.deleteProject(t.target)},deleteProject:function(t){var e=this;this.$confirm("确定要删除["+t.project_name+"]概览吗？将同时删除该项目下的所有概览及概览相关数据","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){d(t.project_id).then((function(t){403!==t.code?(e.getProjects(),e.$message({type:"success",message:e.$t("common.deleteSuccess")})):e.msgError(t.msg)}))}))},viewDashboard:function(t){this.$router.push("/dashboard?project_id=".concat(t))},submitForm:function(){var t=this;this.$refs["form"].validate((function(e){e&&(void 0!=t.form.project_id?a(t.form).then((function(e){if(200===e.code)t.msgSuccess("项目修改成功"),t.open=!1,t.getProjects();else if(403===e.code)return void t.msgError(e.msg)})):i(t.form).then((function(e){200===e.code&&(t.msgSuccess("项目添加成功"),t.open=!1,t.getProjects())})))}))},handleEdit:function(t){var e=this;l(t.project_id).then((function(t){e.form=t.data,e.open=!0,e.title="编辑项目"}))},handleAdd:function(){this.reset(),this.open=!0,this.title="添加项目"},cancel:function(){this.open=!1,this.reset()},reset:function(){this.form={project_name:void 0,project_id:void 0,private_status:1,is_public:!1,project_desc:void 0},this.resetForm("form")},getProjects:function(){var t=this;this.loading=!0,s().then((function(e){t.projectlist=e.rows,t.loading=!1})).catch((function(){t.loading=!1}))}}},m=p,u=(o("19f8"),o("2877")),f=Object(u["a"])(m,r,c,!1,null,"809ff34a",null);e["default"]=f.exports}}]);